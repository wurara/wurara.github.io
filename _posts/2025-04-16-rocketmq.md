---
layout: post
title: ROCKETMQ
subtitle: ROCKETMQ
cover-img: /assets/img/path.jpg
thumbnail-img: /assets/img/thumb.png
share-img: /assets/img/path.jpg
tags: [ROCKETMQ]
---



### ROCKETMQ

##### 领域模型

###### 通信方式

1. 同步
2. 异步

###### 消息传输方式

1. 点对点模型

   只消费一次，不区分消费组

2. 发布订阅模型

   所有订阅组拿到全量消息

##### 主题topic

###### 定义

顶层存储，逻辑概念。由多个队列组成，消息的存储和水平扩展能力由队列实现。

###### 作用

1. 定义数据的分类隔离
2. 定义数据的身份和权限

###### 属性

1. 主题名称
2. 队列列表
3. 消息类型
   1. Normal
   2. FIFO：先进先消费
   3. Delay：定时、延时消息
   4. Transaction：事务消息

###### 要求

1. 消息类型强制校验：一个主题只能有一个类型的topic

##### 队列MessageQueue

###### 定义

消息存储和传输的实际容器，消息的最小存储单元。

存储顺序性，队列头部为最早写入的消息，队列尾部为最新写入的消息。

流式操作语义，队列的存储模型。

所有的消息资源以主题粒度管理，但实际的操作实现是面向队列

###### 属性

1. 读写权限
   1. 6：读写状态，当前队列允许读取消息和写入消息。
   2. 4：只读状态，当前队列只允许读取消息，不允许写入消息。
   3. 2：只写状态，当前队列只允许写入消息，不允许读取消息。
   4. 0：不可读写状态，当前队列不允许读取消息和写入消息。

##### 消息Message

###### 定义

最小数据传输单元。消息不可变性。消息持久化。

###### 属性

1. 主题名称
2. 消息类型
3. 消息队列
4. 消息位点
5. 消息id
6. 索引key列表（可选）
7. 过滤标签tag（可选）
8. 定时时间（可选）
9. 消息发送时间
10. 消息保存时间戳
11. 消费重试次数
12. 业务自定义属性
13. 消息负载

###### 要求

普通和顺序消息：4 MB。事务和定时或延时消息：64 KB。

##### 生产者

###### 内部属性

1. 客户端ID：自动生成
2. 通信参数：接入点信息、身份认证信息、请求超时时间
3. 预绑定主题列表：初始化时就检查主题是否有数据。
4. 事务检查器
5. 发送重试策略

##### 生产者分组

###### 定义

逻辑资源。

##### 消费者

###### 消费特点

##### 消费者分组



